<!DOCTYPE html>
<html>
<head>
    <title>BeadNet demo for Puzzle ITC</title>
    <link rel="stylesheet" href="./docs/styles/jsdoc-default.css">
    <meta charset="utf-8">
    <style>
        body,
        html {
            width: 100%;
            height: 100%;
            margin: 0;
        }

        p {
            margin-left: 20px;
        }

        #beadnet {
            border: 3px solid gray;
            box-sizing: border-box;
            position: absolute;
            top: 20%;
            left: 0;
            bottom: 0;
            right: 25%;
        }

        #controls {
            position: absolute;
            background-color: lightgray;
            top: 20%;
            left: 75%;
            bottom: 0;
            right: 0;
            padding: 1em;
        }

        @font-face {
            font-family: 'bitcoinregular';
            src: url('dist/bitcoin-webfont.eot');
            src: url('dist/bitcoin-webfont.eot?#iefix') format('embedded-opentype'),
            url('dist/bitcoin-webfont.woff2') format('woff2'),
            url('dist/bitcoin-webfont.woff') format('woff'),
            url('dist/bitcoin-webfont.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;

        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    <script src="dist/beadnet.standalone.min.js"></script>
</head>
<body>
<h1 id="beadnet-alpha-preview-">BeadNet demo for Puzzle ITC</h1>
<p>
    A visualisation of how Lightning Network salary payments could work at Puzzle ITC.<br/>
    This demo is based on the <a href="https://github.com/mojoaxel/beadnet">BeadNet library</a> of
    <a href="//github.com/mojoaxel">Alexander Wunschik</a>.
</p>
<br/><br/><br/>
<h4>Todo:</h4>
<ul>
    <li>Allow emulator control as well as simulation</li>
    <li>Optimize channel draw length, node placement. Maybe give some nodes a flag that they're routing nodes.</li>
    <li>Text description of every step</li>
    <li>Node info on click</li>
    <li>Moving beads different color</li>
</ul>

<div id="container">
    <div id="beadnet"></div>
    <div id="controls">
        <fieldset id="add-node">
            <legend>presentation</legend>
            <button id="nextStep">Next Step</button>
        </fieldset>
    </div>

    <script>
        window.onload = function () {

            var colors = d3.scaleOrdinal(d3.schemeCategory10);

            // initialize BeadNet
            window.bn = new beadnet({
                colorScheme: colors,
                presentation: {
                    steps: [
                        [
                            { cmd: 'ADD_NODES', args: [[{ id: 'PuzzleITC', balance: 10 }, { id: 'Digitec', balance: '0' },]] },
                        ],
                        [
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'PuzzleITC', sourceBalance: 10, target: 'Digitec', targetBalance: 0 }] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 2, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 4, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Digitec', 'PuzzleITC', 1, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 3, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Digitec', 'PuzzleITC', 8, null] },
                        ],
                        [
                            {
                                cmd: 'ADD_NODES', args: [[
                                    { id: 'Oli', balance: 10 },
                                    { id: 'Thömu', balance: 10 },
                                    { id: 'Sarah', balance: 10 },
                                    { id: 'Gäbu', balance: 10 },
                                    { id: 'Sombra', balance: 10 },
                                ]]
                            },
                        ],
                        [
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'Oli', sourceBalance: 5, target: 'PuzzleITC', targetBalance: 0 }] },
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'Thömu', sourceBalance: 5, target: 'PuzzleITC', targetBalance: 0 }] },
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'Sarah', sourceBalance: 5, target: 'PuzzleITC', targetBalance: 0 }] },
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'Gäbu', sourceBalance: 5, target: 'PuzzleITC', targetBalance: 0 }] },
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'Sombra', sourceBalance: 5, target: 'PuzzleITC', targetBalance: 0 }] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Oli', 'PuzzleITC', 1, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 1, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Thömu', 'PuzzleITC', 1, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 1, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Gäbu', 'PuzzleITC', 1, null] },
                            { cmd: 'MOVE_BEADS', args: ['Sombra', 'PuzzleITC', 1, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 2, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Oli', 'PuzzleITC', 4, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 4, null] },
                        ],
                        [
                            { cmd: 'ADD_NODES', args: [[{ id: 'Lohn', balance: 6 },]] },
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'Lohn', sourceBalance: 6, target: 'PuzzleITC', targetBalance: 0 }] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Lohn', 'PuzzleITC', 6, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Oli', 3, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Sarah', 1, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Thömu', 1, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Gäbu', 1, null] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Oli', 'PuzzleITC', 2, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Digitec', 2, null] },
                        ],
                        [
                            { cmd: 'ADD_CHANNEL', args: [{ source: 'Oli', sourceBalance: 5, target: 'Gäbu', targetBalance: 0 }] },
                        ],
                        [
                            { cmd: 'MOVE_BEADS', args: ['Oli', 'Gäbu', 3, null] },
                            { cmd: 'MOVE_BEADS', args: ['Gäbu', 'PuzzleITC', 3, null] },
                            { cmd: 'MOVE_BEADS', args: ['PuzzleITC', 'Oli', 3, null] },
                        ],
                        [
                            { cmd: 'REMOVE_CHANNEL', args: ['Gäbu', 'PuzzleITC'] },
                            { cmd: 'REMOVE_CHANNEL', args: ['Oli', 'Gäbu'] },
                        ],
                        [
                            { cmd: 'REMOVE_NODE', args: ['Gäbu'] },
                        ]
                    ]
                }
            });
            bn.nextStep();

            var btnNextStep = document.querySelector('button#nextStep');
            btnNextStep.addEventListener('click', function () {
                bn.nextStep();
            });

        };
    </script>
</div>

</body>
</html>
